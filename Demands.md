# 需求说明

## 网关集成部分
待完善
## 三员权限
应满足对用户最小授权原则进行权限划分，不存在超级管理员。

### 系统管理员
- 用户管理：创建账号，停用账号，删除账号；
- 角色管理：项目内三类人员的权限的确定；
- 系统参数配置。（待定）

### 安全保密员
- 用户密级确定：秘密、机密、绝密；
- 用户授权：项目内成员的角色属于三类人员中的具体哪一类；
- 角色分配：目前阶段按角色授权，三类人员就可以作为其角色，除此之外可能需要根据不同的项目区分三类人员；
- 审计用户：普通业务用户操作日志审计，用户登录日志审计。

### 安全审计员
- 管理员审计:管理三员的所有操作日志，包括登陆、登出、用户管理、角色管理、权限分配、角色分配、日志管理等。
- 相关审计工作
### 日志相关要求
  - 审计日志包括主体、客体、时间、用户登陆IP地址、操作类型、操作内容、操作结果。日志可读性好，且不暴露敏感信息；操作结果包括成功和失败，操作内容为详细操作信息，操作类型包括用户管理、角色管理、创建任务、用户浏览等动作。主体为用户标识关联的用户名等具有可读性的标识，客体为客体表示符关联的客体名。
  - 日志存储在单独的数据库表中，不可被删除、修改、可以备份、导出、导入，导出格式可以选择为syslog、excel表格等格式。日志具有根据主体、客体、时间、IP地址、操作结果等关键字检索功能。
  - 日志至少保存6个月，具有储存空间警告功能，支持基于邮件或页面提示的方式告警，
  - 可生成日志报表，特定关键字特定范围筛选导出报表。
### 可读性要求
  - 操作内容需完整如：给用户授权则需要操作人、用户名、赋予的权限、赋予的角色等所有信息，不能仅记录为给XX授权，敏感数据如项目名称不应记录在日志内。
  - 不应存在歧义：如修改用户信息口令，不能记录为修改用户信息。
  - 日志不能直接套用sql语句。
  - 主体客体信息应具备可读性，如用户信息不应为编号或ID应为姓名或用户名，客体信息不应为对象ID或URL等不可读信息。
  - 使用24小时制，避免12时制造成排序混乱。

####  日志格式
  |属性名    |类型     |描述     |
  |:------: |:------: |:------: |
  |type     |string   |log      |
  |id       |identifier|日志标识符ID|
  |created  |timestamp|创建时间 |
  |modified |timestamp|修改时间原则上不允许修改，应与创建时间一致 |
  |first_observed|timestamp|与创建时间一致|
  |last_observed|timestamp|与实际时间一致|
  |number_observed|integer|观测次数，取值为1|
  |name|string|应用系统名称，EMC平台名称|
  |version|string|版本号|
  |company|string|厂家|
  |kind|integer|行为类别：</br>0:一般行为；</br>1:异常行为；</br>2:违规行为。|
  |level|integer|风险等级：</br>0:紧急</br>1:报警</br>2:关键</br>3:错误</br>4:告警</br>5:通知</br>6:信息</br>7:调试。|
  |description|string|日志描述信息|
  |source_protpcol|string|日志所采用的协议|
